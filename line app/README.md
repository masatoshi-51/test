# LINEメッセージ送信キット

小学生でもわかるように、LINEでメッセージを送る方法をまとめました。  
このフォルダーには Python で LINE にメッセージを送るためのサンプルが入っています。

---

## 1. ぜんぶで何をするの？
1. LINE Developers で秘密の鍵をもらう  
2. パソコンに必要なツール（\`line-bot-sdk\`）を入れる  
3. サンプルスクリプトに鍵と送り先を入れる  
4. ボタン（コマンド）を押して送信！

---

## 2. 事前準備（LINE公式アカウント）
1. https://developers.line.biz/ にアクセスしてログイン  
2. 「プロバイダー」「チャネル（Messaging API）」を作成  
3. チャネルの「Messaging API設定」ページで  
   - **チャネルアクセストークン（長期）** をコピー  
   - **あなた（または送りたい人）のユーザーID** をメモ  
4. LINE公式アカウントと友だちになっておく

> このアクセストークンは誰にも見せないでください。パスワードのようなものです。

---

## 3. Python の準備
1. コマンドプロンプト（PowerShell）を開く  
2. このフォルダー（`Line`）に移動  
3. 次を実行してライブラリを入れる
   ```
   pip install -r requirements.txt
   ```

---

## 4. サンプルファイルの設定
`send_line_message.py` の次の2か所を書き換えます。
- `CHANNEL_ACCESS_TOKEN = "..."` → 自分のアクセストークンを貼る  
- `USER_ID = "..."` → 送りたい相手（自分もOK）のユーザーID

---

## 5. メッセージを送ってみよう
1. もう一度コマンドプロンプトで Line フォルダーにいるか確認  
2. 次を実行
   ```
   python send_line_message.py
   ```
3. LINE に「PythonからLINEを送ってみたよ。」と届けば成功！

---

## 6. うまくいかないとき
- トークン・ユーザーIDが正しいか確認  
- 友だち追加を忘れていないか確認  
- ネットワーク制限でブロックされていないか確認  
- エラーメッセージが出たら、その内容をコピーして検索するとヒントになります

---

## 7. 次のステップ
- メッセージ文を変えてみる  
- 複数人へ送る（ユーザーIDをリストで管理）  
- Webhook を使って自動返信ロボを作る

---

## 8. 「◯時に△△する」と送るとリマインドするボット

### 8-1. ゴールのイメージ
1. ボットに「10時に宿題をやる」「15:30に散歩する」と送る  
2. Python がメッセージの中から時刻を読み取り、今日のその時間にアラームを予約  
3. 時刻になると LINE に「◯◯の時間です！」と教えてくれる

### 8-2. 準備するもの
- チャネルアクセストークン（長期）  
- **チャネルシークレット**  
- ボットをインターネットに公開するURL（クラウド or ngrok）  
- ライブラリ：`line-bot-sdk`, `Flask`, `APScheduler`

> `pip install -r requirements.txt` を実行すると必要なライブラリがすべて入り、`reminder_bot.py` もダウンロード済みです。

### 8-3. ファイルを書き換える
1. `Line/reminder_bot.py` を開く  
2. 先頭の `CHANNEL_ACCESS_TOKEN` と `CHANNEL_SECRET` を自分の値に変更  
3. もしくは PowerShell で環境変数を登録（値はそれぞれ貼り付け）
   ```
   setx LINE_CHANNEL_ACCESS_TOKEN "ここにトークン"
   setx LINE_CHANNEL_SECRET "ここにシークレット"
   ```
4. 新しい PowerShell を開き直すと環境変数が使えます

### 8-4. ざっくり動き
- `reminder_bot.py` は Flask という小さなWebサーバー  
- LINEが送ってきたメッセージを `/callback` で受信  
- 「10時に宿題をやる」が来たら APScheduler に「今日の10時」の予定を登録  
- 10:00 になった瞬間に `push_message` でリマインドを送ります

### 8-5. 起動までのステップ（ローカル例）
1. PowerShell で `Line` フォルダーに移動  
2. まだならライブラリを入れる  
   ```
   pip install -r requirements.txt
   ```
3. サーバーを起動  
   ```
   python reminder_bot.py
   ```
4. `Running on http://0.0.0.0:8000` が出ていたらOK（止めるときは Ctrl + C）

### 8-6. インターネットからアクセスできるようにする
1. ngrok をインストールしておく  
2. 別のPowerShellで次を実行  
   ```
   ngrok http 8000
   ```
3. 表示された `https://～～.ngrok-free.app`（httpsの方）をコピー  
4. LINE Developers > Messaging API設定 > Webhook URL に `https://～～/callback` を貼る  
5. 「接続確認」で成功 → 「Webhook利用」を ON

### 8-7. 本番テスト
1. ボットと友だちになる（LINEアプリでQRなどから追加）  
2. ボットへ「10時に宿題をやる」「18時30分にご飯を作る」など送りたい内容を送信  
3. すぐに「◯◯ に『△△』をリマインドするね」と返信される  
4. その時間になると「△△の時間です」とメッセージが届く

### 8-8. よくあるつまずき
- 401エラー…アクセストークン or シークレットが違う  
- 400エラーで `to` が不正…ユーザーIDが間違い / 友だち未追加  
- Webhookが動かない…ngrokのURLを貼り忘れ / Webhook利用がOFF  
- PCを閉じると止まる…常時稼働させたい場合は Render・Railway などのクラウドで動かす

---

---

楽しんで学んでください！

