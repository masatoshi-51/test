# Slack API メッセージ投稿 - 完全ガイド（初心者向け）

## 📋 このガイドの目的

このガイドでは、**全くの初心者でも** Slack に自動でメッセージを投稿できるようになることを目指します。
専門用語はできるだけ使わず、**手順を1つずつ**説明します。

---

## 🎯 全体の流れ（3ステップ）

1. **準備するもの**：Slack のアカウントとワークスペース
2. **ボットを作る**：Slack に「自動でメッセージを送るロボット」を作成
3. **プログラムを動かす**：Python でメッセージを送信

---

## 📦 ステップ1: 必要なものをインストール

### 1-1. Python がインストールされているか確認

**Windows の場合**：
1. スタートメニューを開く
2. 「cmd」と入力して「コマンドプロンプト」を開く
3. 以下のコマンドを入力して Enter キーを押す：
   ```
   python --version
   ```
4. バージョンが表示されれば OK（例：`Python 3.11.0`）
5. エラーが出る場合は、Python をインストールしてください

### 1-2. 必要なパッケージをインストール

1. コマンドプロンプトで、以下のコマンドを実行して `slack` フォルダに移動：
   ```
   cd "C:\Users\hanhj\OneDrive\デスクトップ\前田のSAMURAI\AI\テスト\slack"
   ```
   ※ パスが違う場合は、実際のパスに変更してください

2. 以下のコマンドを実行：
   ```
   pip install -r requirements.txt
   ```
3. 「Successfully installed」と表示されれば OK

---

## 🤖 ステップ2: Slack ボットを作成する

### 2-1. Slack API のページを開く

1. ブラウザで以下のURLを開く：
   ```
   https://api.slack.com/apps
   ```
2. 自分の Slack アカウントでログインする

### 2-2. 新しいアプリを作成

1. ページの右上にある **「Create New App」** ボタンをクリック
2. **「From scratch」** を選択
3. 以下の情報を入力：
   - **App Name**（アプリ名）：好きな名前を入力（例：`テストボット`）
   - **Pick a workspace**（ワークスペース）：自分のワークスペースを選択
4. **「Create App」** ボタンをクリック

### 2-3. ボットに権限を付与する

1. 左側のメニューから **「OAuth & Permissions」** をクリック
2. ページを下にスクロールして、**「Scopes」** というセクションを見つける
3. **「Bot Token Scopes」** の下にある **「Add an OAuth Scope」** ボタンをクリック
4. 以下の権限を追加（1つずつ追加）：
   - `chat:write` → 追加
   - `channels:read` → 追加（任意ですが、おすすめ）

### 2-4. ワークスペースにインストール

1. 同じページ（OAuth & Permissions）の一番上を見る
2. **「OAuth Tokens」** というセクションがある
3. その中に **「Install to test」** という緑色のボタンがある → クリック
4. 承認画面が表示されるので、**「許可する」** をクリック

### 2-5. Bot Token をコピー

1. インストール後、同じページ（OAuth & Permissions）に戻る
2. **「OAuth Tokens」** セクションを見る
3. **「Bot User OAuth Token」** という項目がある
4. その下に `xoxb-` で始まる長い文字列がある → これをコピー
   - 例：`xoxb-1234567890-1234567890123-abcdefghijklmnopqrstuvwx`
5. **重要**：このトークンは他人に見せないでください！

### 2-6. Bot Token を設定ファイルに保存

1. `slack` フォルダの中にある `config.py` ファイルを開く
2. 以下の行を見つける：
   ```python
   SLACK_BOT_TOKEN = ""
   ```
3. 空の `""` の中に、コピーしたトークンを貼り付ける：
   ```python
   SLACK_BOT_TOKEN = "xoxb-あなたがコピーしたトークン"
   ```
4. ファイルを保存

---

## 🔍 ステップ2.5: 接続テスト（オプション）

設定が正しいか確認したい場合は、テストスクリプトを実行できます：

1. コマンドプロンプトで、`slack` フォルダに移動
2. 以下のコマンドを実行：
   ```
   python test_connection.py
   ```
3. 結果を確認：
   - ✅ すべて OK なら、次のステップに進めます
   - ❌ エラーが出た場合は、エラーメッセージを確認して修正してください

---

## 📤 ステップ3: メッセージを送信する

### 3-1. ボットをチャンネルに追加

**重要**：ボットをチャンネルに追加しないと、メッセージを送れません！

1. Slack アプリを開く
2. メッセージを送りたいチャンネルを開く（例：`#general`）
3. チャンネル名をクリックして、チャンネルの詳細を開く
4. **「統合」** または **「Integrations」** タブを開く
5. **「アプリを追加」** または **「Add apps」** をクリック
6. 作成したボット（ステップ2-2で付けた名前）を検索して追加

**別の方法**：
- チャンネルで `/invite @ボット名` と入力して Enter

### 3-2. メッセージを送信

1. コマンドプロンプトで、`slack` フォルダに移動していることを確認
2. 以下のコマンドを実行（例）：
   ```
   python slack_send_message.py --channel "#general" --message "こんにちは！テストです"
   ```
   - `#general` の部分は、送りたいチャンネル名に変更
   - `こんにちは！テストです` の部分は、送りたいメッセージに変更

3. **成功した場合**：
   ```
   ✅ メッセージを投稿しました
     チャンネル: #general
     メッセージ: こんにちは！テストです
   ```
   と表示され、Slack のチャンネルにメッセージが表示されます

---

## ❌ よくあるエラーと解決方法

### エラー0: `[Errno 2] No such file or directory`

**原因**：`slack` フォルダに移動していない、またはファイルが見つからない

**解決方法**：
1. コマンドプロンプトで、現在のフォルダを確認：
   ```
   cd
   ```
2. `slack` フォルダに移動：
   ```
   cd "C:\Users\hanhj\OneDrive\デスクトップ\前田のSAMURAI\AI\テスト\slack"
   ```
3. ファイルがあるか確認：
   ```
   dir
   ```
4. それからコマンドを実行

**詳細は**：`エラー解決ガイド.md` を参照してください

---

### エラー1: `SLACK_BOT_TOKEN が設定されていません`

**原因**：`config.py` にトークンが設定されていない

**解決方法**：
1. `config.py` を開く
2. `SLACK_BOT_TOKEN = ""` の `""` の中に、ステップ2-5でコピーしたトークンを貼り付ける
3. 保存して、もう一度実行

### エラー2: `channel_not_found`

**原因**：チャンネル名が間違っている、またはボットがチャンネルに追加されていない

**解決方法**：
1. チャンネル名が正しいか確認（`#` は付けても付けなくてもOK）
2. ステップ3-1でボットをチャンネルに追加したか確認
3. チャンネルIDを使う方法：
   - Slack でチャンネル名をクリック → 詳細を開く → 一番下に「チャンネルID」がある
   - それをコピーして、`--channel "C1234567890"` のように使う

### エラー3: `not_in_channel`

**原因**：ボットがチャンネルに参加していない

**解決方法**：
1. ステップ3-1を実行して、ボットをチャンネルに追加する

### エラー4: `invalid_auth`

**原因**：Bot Token が間違っている、または無効になっている

**解決方法**：
1. ステップ2-5でトークンを正しくコピーしたか確認
2. `config.py` に正しく貼り付けられているか確認（前後に余分なスペースがないか）
3. もしまだダメなら、ステップ2-4からやり直す（再インストール）

### エラー5: `Could not open requirements file`

**原因**：`slack` フォルダに移動していない

**解決方法**：
1. コマンドプロンプトで以下を実行：
   ```
   cd "C:\Users\hanhj\OneDrive\デスクトップ\前田のSAMURAI\AI\テスト\slack"
   ```
2. それから `pip install -r requirements.txt` を実行

---

## 📝 使用例

### 例1: 基本的なメッセージ送信
```
python slack_send_message.py --channel "#general" --message "おはようございます"
```

### 例2: チャンネルIDで指定
```
python slack_send_message.py --channel "C1234567890" --message "テスト"
```

### 例3: 短いコマンド（-c と -m を使う）
```
python slack_send_message.py -c "#general" -m "こんにちは"
```

---

## 🔍 現在の状態を確認する方法

### 1. ファイルが正しく配置されているか確認

`slack` フォルダの中に以下のファイルがあるか確認：
- ✅ `slack_send_message.py` - メインのプログラム
- ✅ `config.py` - 設定ファイル（トークンを保存）
- ✅ `requirements.txt` - 必要なパッケージのリスト
- ✅ `README.md` - 説明書

### 2. config.py にトークンが設定されているか確認

`config.py` を開いて、以下のようになっているか確認：
```python
SLACK_BOT_TOKEN = "xoxb-実際のトークンがここに入っている"
```
空の `""` のままではダメです！

### 3. パッケージがインストールされているか確認

コマンドプロンプトで以下を実行：
```
pip list | findstr slack
```
`slack-sdk` が表示されれば OK

---

## 💡 まとめ

1. ✅ **Python をインストール**
2. ✅ **必要なパッケージをインストール**（`pip install -r requirements.txt`）
3. ✅ **Slack でボットを作成**（https://api.slack.com/apps）
4. ✅ **ボットに権限を付与**（`chat:write`）
5. ✅ **ワークスペースにインストール**（「Install to test」ボタン）
6. ✅ **Bot Token をコピー**
7. ✅ **config.py にトークンを貼り付け**
8. ✅ **ボットをチャンネルに追加**
9. ✅ **メッセージを送信**（`python slack_send_message.py --channel "#チャンネル名" --message "メッセージ"`）

---

## 🆘 まだわからない場合

1. **まず接続テストを実行**：
   ```
   python test_connection.py
   ```
   これで、どこに問題があるかがわかります

2. どのステップで止まっているか確認
3. エラーメッセージをコピーして、上記の「よくあるエラー」と照らし合わせる
4. `config.py` にトークンが正しく設定されているか再確認
5. ボットがチャンネルに追加されているか再確認
6. `状態確認チェックリスト.md` を使って、一つずつ確認する

---

**頑張ってください！** 🚀

